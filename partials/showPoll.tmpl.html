<material-dialog>
  <div id="materialDialogContainer" ng-show="poll.status === 'started' || poll.status === 'stopped' || poll.status === 'voted'" ng-class="{running: poll.status === 'started', completed: poll.status === 'stopped' || poll.status === 'voted'}" ng-mouseover="dialog.menubar = true" ng-mouseleave="dialog.menubar = false">

    <div class="dialog-content">
      <div class="pollInformation">
        <div layout="horizontal" layout-align="space-between">
          <span ng-show="endPollDate">
            Poll ends in {{endPollDate}}
          </span>
          <span>{{poll.originator}}</span>
        </div>
        <h2>{{poll.title}}</h2>
        <p>
          {{poll.description}}
        </p>

        <div id="ballotResults" ng-if="poll.status === 'voted'">
          <em>PUBLIC RESULTS ARE NOT AVAILABLE FOR THIS POLL</em>
          <div class="options">
            <table>
              <tr><td colspan="2">YOU VOTED:</td></tr>
              <tr ng-repeat="option in poll.options | filter:{isSelected:true}">  
                <td class="previewCheckbox"><img ng-src="material-icons/icons/system_icons/toggle/res/1x_web/ic_check_box_18dp.png"></td>
                <td>{{option.text}}</td>
              </tr>
            </table>
          </div>
        </div>

        <div id="statsBox" ng-if="poll.status != 'voted'">
          <span class="tableTitle"><b>Poll Stats:</b></span>
          <table id="pollStatsTable">
            <tr>
              <td>Sent</td>
              <td>{{poll.stats.sent}}</td>
            </tr>
            <tr>
              <td>Responded</td>
              <td>{{poll.stats.responded}}</td>
            </tr>
            <tr>
              <td>Pending</td>
              <td>{{poll.stats.pending}}</td>
            </tr>
            <tr>
              <td>Invalid</td>
              <td>{{poll.stats.invalid}}</td>
            </tr>
          </table>
        </div>

        <div id="resultsBox" layout="horizontal" layout-align="space-between" ng-if="poll.status != 'voted'">
          <div style="width:50%"> 
            <span class="tableTitle"><b>Poll Results:</b></span>
            <table id="pollResultsTable">
              <tr ng-repeat="option in poll.options">
                <td>{{option.text}}</td>
                <td>{{option.count}}</td>
              </tr>
            </table>

          </div>
          <div class="bigPieChartContainer" ng-if="(poll.status === 'stopped' || poll.status === 'voted') && hasData(poll.options)">
            
            <nvd3-pie-chart
              id="big"
              data="poll.options"
              x="xFunction()"
              y="yFunction()"
              width="200"
              height="200"
              margin="{left: 15, top: 15, bottom: 15, right: 15}"
              showLabels="true"
              pieLabelsOutside="true"
              showValues="true"
              labelType="key"
              tooltips="true">
              <svg height="100"></svg>
            </nvd3-pie-chart>
  
          </div>
        </div>
        <div class="clearBoth"></div>
      </div>
    </div>
    <div class="dialog-actions" layout="horizontal" layout-align="end">
      <material-button id="closeButton" ng-click="close()">
        Close
      </material-button>
    </div>

    <div id="actionMenuBar" class="cardMenuBar animate-show" ng-show="dialog.menubar" style="display:block !important;">
      <div class="dialog-menubar-actions">
        <material-button id="showCommentsButton" ng-if="poll.allowComments" class="material-button-icon" ng-click="showComments($event, poll)" title="Show Poll Comments">
          <img ng-src="material-icons/icons/system_icons/communication/res/1x_web/ic_chat_wht_18dp.png">
        </material-button>
        <material-button id="copyPollButton" class="material-button-icon" ng-click="copyPoll($event, poll)" title="Copy This Poll">
          <img ng-src="material-icons/icons/system_icons/content/res/1x_web/ic_content_copy_wht_18dp.png">
        </material-button>
        <material-button id="deletePollButton" class="material-button-icon" ng-really-message="Are you sure you want to delete this poll?" ng-really-click="destroyPoll(poll)" title="Delete This Poll">
          <img ng-src="material-icons/icons/system_icons/action/res/1x_web/ic_delete_wht_18dp.png">
        </material-button>
      </div>
    </div>

  </div>
</material-dialog>